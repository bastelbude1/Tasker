# TEST_METADATA: {"description": "Conditional min_success=3 with only 1 success - takes on_failure path","test_type": "positive","expected_exit_code": 0,"expected_success": true,"skip_host_validation": true,"expected_execution_path": [0,1,99]}

# Test Section 10.2: Multi-Task Success Evaluation with on_success/on_failure routing
# min_success=3 with only 1 success - condition NOT met - takes on_failure path

TEST_MODE=true

task=0
hostname=localhost
command=/usr/bin/echo
arguments=Testing min_success=3 with only 1 success out of 3 tasks
exec=local

# Conditional block with min_success=3 condition
# 1 task succeeds, 2 tasks fail - min_success NOT met
task=1
type=conditional
condition=@TEST_MODE@=true
if_true_tasks=10,11,12
if_false_tasks=98
success=min_success=3
on_success=2
on_failure=99

# Task 2: on_success handler (should NOT execute)
task=2
hostname=localhost
command=/usr/bin/echo
arguments=ERROR: Should not reach on_success handler
exec=local
return=1

# Subtask 10: SUCCESS
task=10
hostname=localhost
command=/usr/bin/true
exec=local

# Subtask 11: FAILED
task=11
hostname=localhost
command=/usr/bin/false
exec=local

# Subtask 12: FAILED
task=12
hostname=localhost
command=/usr/bin/false
exec=local

# Task 98: False branch placeholder (should NOT execute - condition is true)
task=98
hostname=localhost
command=/usr/bin/echo
arguments=ERROR: Should not reach false branch
exec=local
return=1

# Task 99: on_failure handler (SHOULD execute - only 1/3 succeeded)
task=99
hostname=localhost
command=/usr/bin/echo
arguments=SUCCESS: on_failure handler - min_success=3 not met (only 1/3 succeeded)
exec=local
