# TEST_METADATA: {"description": "Conditional Block test - nested conditionals NOT supported", "test_type": "negative", "expected_exit_code": 20, "expected_success": false, "validation_only": true}

# Test nested conditional blocks - VALIDATION SHOULD FAIL
# TASKER does not support nested conditional/parallel tasks (task 11 is conditional, referenced by task 1)
# This test verifies that the validator correctly rejects nested conditionals with exit code 20

task=0
hostname=localhost
command=echo
arguments=PRODUCTION
exec=local

# First level conditional
task=1
type=conditional
condition=@0_stdout@=PRODUCTION
if_true_tasks=10,11
if_false_tasks=20

# True branch task that sets up nested condition
task=10
hostname=localhost
command=echo
arguments=ACTIVE
exec=local

# Nested conditional within true branch
task=11
type=conditional
condition=@10_stdout@=ACTIVE
if_true_tasks=100,101
if_false_tasks=200,201

# Nested true branch - should execute
task=100
hostname=localhost
command=echo
arguments=Nested TRUE: System is PRODUCTION and ACTIVE
exec=local

task=101
hostname=localhost
command=echo
arguments=Performing production operations
exec=local

# Nested false branch - should be skipped
task=200
hostname=localhost
command=echo
arguments=Nested FALSE: Should not execute
exec=local

task=201
hostname=localhost
command=echo
arguments=This should be skipped
exec=local

# First level false branch - should be skipped
task=20
hostname=localhost
command=echo
arguments=First level FALSE: Should not execute
exec=local

# Final task
task=2
hostname=localhost
command=echo
arguments=Nested conditional completed
exec=local