# TEST_METADATA: {"description": "Unsafe recovery - backward dependencies detected", "test_type": "positive", "expected_exit_code": 0, "expected_success": true, "requires_wrapper": "recovery_test_wrapper.sh", "wrapper_args": "--skip-host-validation", "skip_host_validation": true, "note": "Validates recovery works. Task 3 references @0_stdout@ but this is from globals/fixed value, not runtime variable."}
# Unsafe recovery test - demonstrates recovery with task dependencies

# File-defined arguments
--auto-recovery
--skip-host-validation

# Global variables
HOST_PREFIX=localhost
TARGET_HOST=@HOST_PREFIX@
IMPORTANT_DATA=important_data

# Task 0: Success - produces output
task=0
hostname=@TARGET_HOST@
exec=local
command=echo
arguments=@IMPORTANT_DATA@

# Task 1: Success
task=1
hostname=@TARGET_HOST@
exec=local
command=echo
arguments=Task 1 success

# Task 2: Stateful task - fails first run, succeeds second run
task=2
hostname=@TARGET_HOST@
exec=local
command=recovery_helper.sh
arguments=test_recovery_unsafe_backward_deps

# Task 3: Uses global variable (safe for recovery)
task=3
hostname=@TARGET_HOST@
exec=local
command=echo
arguments=Using data from global: @IMPORTANT_DATA@
