# TEST_METADATA: {"description": "Recovery with global variables preservation", "test_type": "positive", "expected_exit_code": 0, "expected_success": true, "requires_auto_recovery": true, "note": "Tests that global variables are preserved across recovery"}
# Recovery with global variables test

# File-defined arguments
--auto-recovery
--skip-host-validation

# Global variables
APP_NAME=MyApplication
APP_VERSION=1.0.0
DEPLOY_ENV=production
TARGET_HOST=@APP_NAME@-@DEPLOY_ENV@

# Task 0: Use global variables
task=0
hostname=localhost
exec=local
command=echo
arguments=Deploying @APP_NAME@ version @APP_VERSION@ to @DEPLOY_ENV@

# Task 1: Use composed global variable
task=1
hostname=localhost
exec=local
command=echo
arguments=Target host: @TARGET_HOST@

# Task 2: Success
task=2
hostname=localhost
exec=local
command=echo
arguments=Task 2 using @APP_NAME@

# Task 3: Success
task=3
hostname=localhost
exec=local
command=echo
arguments=Completed deployment of @APP_NAME@ @APP_VERSION@
