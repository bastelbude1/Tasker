# TEST_METADATA: {"description": "Command injection global vars test","test_type": "security_negative","expected_exit_code": 20,"expected_success": false,"risk_level": "high","skip_host_validation": true,"security_category": "command_injection"}
# COMMAND INJECTION GLOBAL VARIABLES TEST
# Tests command injection attempts through global variable definitions

# INJECTION: Command injection in global variable value
MALICIOUS_VAR=test; cat /etc/passwd; echo
INJECTION_VAR=$(whoami)
BACKTICK_VAR=`cat /etc/passwd`

# Valid start task using potentially injected global variables
task=0
hostname=localhost
command=echo
arguments=Global var test: @MALICIOUS_VAR@
success=exit_0
on_success=1

# Task using command substitution global var
task=1
hostname=localhost
command=echo
arguments=Injection var: @INJECTION_VAR@
success=exit_0
on_success=2

# Task using backtick global var
task=2
hostname=localhost
command=echo
arguments=Backtick var: @BACKTICK_VAR@
success=exit_0
on_success=3

# INJECTION: Complex injection through global variable expansion
task=3
hostname=@MALICIOUS_VAR@
command=echo
arguments=Using injected hostname from global var
success=exit_0