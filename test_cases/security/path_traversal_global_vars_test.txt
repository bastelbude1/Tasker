# TEST_METADATA: {"description": "Path traversal global vars test","test_type": "security_negative","expected_exit_code": 20,"expected_success": false,"risk_level": "high","skip_host_validation": true,"security_category": "path_traversal"}
# PATH TRAVERSAL GLOBAL VARIABLES TEST
# Tests path traversal through global variable injection

# TRAVERSAL: Global variables with path traversal
MALICIOUS_PATH=../../../etc/passwd
ENCODED_PATH=%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
WINDOWS_PATH=..\..\..\windows\system32\config\sam

# Valid start task
task=0
hostname=localhost
command=echo
arguments=Starting path traversal global vars test
success=exit_0
on_success=1

# TRAVERSAL: Using global variable with path traversal
task=1
hostname=localhost
command=cat
arguments=@MALICIOUS_PATH@
success=exit_0
on_success=2

# TRAVERSAL: Using encoded path global variable
task=2
hostname=localhost
command=cat
arguments=@ENCODED_PATH@
success=exit_0
on_success=3

# TRAVERSAL: Using Windows path global variable
task=3
hostname=localhost
command=type
arguments=@WINDOWS_PATH@
success=exit_0
on_success=4

# TRAVERSAL: Concatenated path traversal
task=4
hostname=localhost
command=cat
arguments=/tmp/@MALICIOUS_PATH@
success=exit_0