# TEST_METADATA: {"description": "Resource exhaustion test","test_type": "security_negative","expected_exit_code": 20,"expected_success": false,"risk_level": "high","skip_host_validation": true,"security_category": "resource_exhaustion"}
# RESOURCE EXHAUSTION TEST
# Tests various resource exhaustion attack vectors

# Valid start task
task=0
hostname=localhost
command=echo
arguments=Starting resource exhaustion test
success=exit_0
on_success=1

# EXHAUSTION: Excessive timeout values
task=1
hostname=localhost
command=sleep
arguments=999999999
timeout=999999999
success=exit_0
on_success=2

# EXHAUSTION: Excessive retry attempts
task=2
hostname=localhost
command=false
retry_failed=true
retry_count=999999
success=exit_0
on_success=3

# EXHAUSTION: Large loop count
task=3
hostname=localhost
command=echo
arguments=Loop test
loop=999999
success=exit_0
on_success=4

# EXHAUSTION: Deep recursion through task jumps
task=4
hostname=localhost
command=echo
arguments=Recursion test depth 1
success=exit_0
on_success=5

task=5
hostname=localhost
command=echo
arguments=Recursion test depth 2
success=exit_0
on_success=6

task=6
hostname=localhost
command=echo
arguments=Attempting deep recursion
success=exit_0
on_success=4